  Current date and time: 25-Apr-2024 07:40:43
=====================================================
    Welcome to EM modeling and inversion code        
    -------------lib_EMMI_MGFD---------------        
            Author: Pengliang Yang                   
            E-mail: ypl.2100@gmail.com               
    Copyright (c) 2023. All rights reserved.         
=====================================================
Task: Inversion for medium parameters 
=====================================================
freq[0]=0.25 
freq[1]=1 
freq[2]=2.75 
Active source channels: Ex
Active recever channels: Ex
[nx, ny, nz]=[100, 100, 100]
[dx, dy, dz]=[200, 200, 40]
[ox, oy, oz]=[-10000, -10000, 0]
istrech=0 
addair=1, nb_air=10, rho_air=1e+08 Ohm*m 
GMG grid size: [n1pad, n2pad, n3pad]=[129, 129, 129]
****** isrc=21 nrec=810, [x,y,z,azimuth,dip]=[-8196.15, 2196.15, 895.752, 30, 0]
****** isrc=19 nrec=810, [x,y,z,azimuth,dip]=[1098.08, 4098.08, 902.369, 30, 0]
****** isrc=20 nrec=810, [x,y,z,azimuth,dip]=[3696.15, 5598.08, 940.45, 30, 0]
****** isrc=16 nrec=810, [x,y,z,azimuth,dip]=[-6696.15, -401.924, 875.798, 30, 0]
****** isrc=18 nrec=810, [x,y,z,azimuth,dip]=[-1500, 2598.08, 872.511, 30, 0]
****** isrc=17 nrec=810, [x,y,z,azimuth,dip]=[-4098.08, 1098.08, 862.813, 30, 0]
****** isrc=25 nrec=810, [x,y,z,azimuth,dip]=[2196.15, 8196.15, 985.874, 30, 0]
****** isrc=2 nrec=810, [x,y,z,azimuth,dip]=[401.924, -6696.15, 870.258, 30, 0]
****** isrc=3 nrec=810, [x,y,z,azimuth,dip]=[3000, -5196.15, 834.03, 30, 0]
****** isrc=4 nrec=810, [x,y,z,azimuth,dip]=[5598.08, -3696.15, 810.434, 30, 0]
****** isrc=5 nrec=810, [x,y,z,azimuth,dip]=[8196.15, -2196.15, 809.226, 30, 0]
****** isrc=6 nrec=810, [x,y,z,azimuth,dip]=[-3696.15, -5598.08, 865.961, 30, 0]
****** isrc=10 nrec=810, [x,y,z,azimuth,dip]=[6696.15, 401.924, 821.754, 30, 0]
****** isrc=11 nrec=810, [x,y,z,azimuth,dip]=[-5196.15, -3000, 858.63, 30, 0]
****** isrc=12 nrec=810, [x,y,z,azimuth,dip]=[-2598.08, -1500, 832.79, 30, 0]
****** isrc=13 nrec=810, [x,y,z,azimuth,dip]=[0, 0, 825, 30, 0]
****** isrc=14 nrec=810, [x,y,z,azimuth,dip]=[2598.08, 1500, 840.608, 30, 0]
****** isrc=1 nrec=810, [x,y,z,azimuth,dip]=[-2196.15, -8196.15, 903.652, 30, 0]
lensrc=275, nsubsrc=1
lenrec=8, nsubrec=1
original domain [x1min, x1max]=[-10000, 10000]
original domain [x2min, x2max]=[-10000, 10000]
original domain [x3min, x3max]=[0, 4000]
nsrc_total=25
nrec_total=810
---------------------------------------
npar=2
**** method=0 (0=l-BFGS; 1=Gauss-Newton)
**** niter=30
**** nls=5
**** bound=1
**** ncg=5
**** preco=2
**** [lb,ub]=[1, 100]
preco=2 (0=off; 1=Shin's preconditioner; 2=depth weighting; 3=triangle smoothing)
Amplitude uncertainty: 3%
noisefloorE=1e-15, noisefloorH=1e-13
Tikhonov regularization: gamma1=100
TV regularization:       gamma2=0
----------- fwi init ------------
****** isrc=7 nrec=810, [x,y,z,azimuth,dip]=[-1098.08, -4098.08, 832.172, 30, 0]
maximum water depth: depthmax=995.951
****** isrc=9 nrec=810, [x,y,z,azimuth,dip]=[4098.08, -1098.08, 802.881, 30, 0]
****** isrc=8 nrec=810, [x,y,z,azimuth,dip]=[1500, -2598.08, 807.18, 30, 0]
****** isrc=15 nrec=810, [x,y,z,azimuth,dip]=[5196.15, 3000, 874.203, 30, 0]
****** isrc=23 nrec=810, [x,y,z,azimuth,dip]=[-3000, 5196.15, 919.802, 30, 0]
****** isrc=24 nrec=810, [x,y,z,azimuth,dip]=[-401.924, 6696.15, 954.6, 30, 0]
****** isrc=22 nrec=810, [x,y,z,azimuth,dip]=[-5598.08, 3696.15, 896.936, 30, 0]
addnoise=1, target rmse=1.021664e+00
fg_fwi iter=0: [rhomin,rhomax]=[0.3,1.5]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 1.5]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.023476e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=7.806705e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.755872e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.684255e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=4.925651e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=7.894899e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 1.5]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.569049e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.168700e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.429400e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.177602e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.739964e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 1.5]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.659038e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.072414e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=4.056695e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=9.139538e-12
isrc=22, fcost=42311.3, rmse=5.9012
isrc=19, fcost=114337, rmse=9.70075
isrc=17, fcost=79846.5, rmse=8.10662
isrc=21, fcost=31781.6, rmse=5.11446
isrc=25, fcost=29618, rmse=4.9373
isrc=13, fcost=245625, rmse=14.2183
isrc=2, fcost=51837.7, rmse=6.53183
isrc=10, fcost=120427, rmse=9.95573
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=31789.1, rmse=5.11506
isrc=7, fcost=116134, rmse=9.77667
isrc=11, fcost=54203.6, rmse=6.67922
isrc=4, fcost=64256.5, rmse=7.27228
isrc=23, fcost=44405.8, rmse=6.04549
isrc=16, fcost=50078.1, rmse=6.42001
isrc=15, fcost=143710, rmse=10.8757
isrc=20, fcost=62924.2, rmse=7.19649
isrc=24, fcost=38558.5, rmse=5.63342
isrc=8, fcost=218871, rmse=13.4217
isrc=5, fcost=41606.7, rmse=5.85186
isrc=12, fcost=138640, rmse=10.6821
isrc=3, fcost=67522.2, rmse=7.45478
isrc=18, fcost=117868, rmse=9.84939
isrc=6, fcost=45480.3, rmse=6.1182
isrc=9, fcost=220806, rmse=13.4808
fcost_dat=2.43212e+06, rmse=8.94817
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=259480, rmse=14.6138
unextended model [rhomin, rhomax]=[0.3, 1.5]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.896887e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=2.022702e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=7.732274e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=6.574167e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.238844e+07
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.122691e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=6.250125e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=1.070706e+05
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 1.5]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.555921e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=2.287137e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.192428e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.928738e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.613049e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.552993e+05
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 1.5]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.054223e+12
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.406666e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=9.939544e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.672764e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=5.102228e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=2.43212e+06
fcost_mod=0
fcost=2.43212e+06
|x|_1=1.13139e+06, |g|_1=4.39574e+06, scaling=0.000514764
==========================================================
# iter=0  fk/f0=1
fg_fwi iter=0: [rhomin,rhomax]=[0.3,1.67929]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 1.67929]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.023596e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=7.821368e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.756329e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.686334e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=4.935246e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=7.901860e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 1.67929]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.568046e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.168509e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.427710e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.176176e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.739460e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 1.67929]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.654176e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.071640e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=4.050959e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=9.114120e-12
isrc=19, fcost=109416, rmse=9.48969
isrc=22, fcost=38885.4, rmse=5.65725
isrc=17, fcost=74886.9, rmse=7.85081
isrc=25, fcost=27716.9, rmse=4.77622
isrc=21, fcost=29669.8, rmse=4.94162
isrc=2, fcost=48110.1, rmse=6.29259
isrc=13, fcost=241608, rmse=14.1016
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=29525.4, rmse=4.92958
isrc=10, fcost=117996, rmse=9.85473
isrc=4, fcost=60300.5, rmse=7.04486
isrc=7, fcost=111784, rmse=9.59183
isrc=11, fcost=50952.6, rmse=6.47582
isrc=23, fcost=40889.7, rmse=5.80121
isrc=15, fcost=141588, rmse=10.7951
isrc=16, fcost=47032.8, rmse=6.22174
isrc=20, fcost=59965.7, rmse=7.02528
isrc=24, fcost=35485.6, rmse=5.40428
isrc=12, fcost=134473, rmse=10.5203
isrc=5, fcost=39358.6, rmse=5.69156
isrc=8, fcost=214415, rmse=13.2843
isrc=18, fcost=112254, rmse=9.61198
isrc=3, fcost=63188.6, rmse=7.21159
isrc=6, fcost=42433.9, rmse=5.90974
isrc=9, fcost=217241, rmse=13.3716
fcost_dat=2.34539e+06, rmse=8.78717
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=256208, rmse=14.5214
unextended model [rhomin, rhomax]=[0.3, 1.67929]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.866587e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.991683e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=7.663402e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=6.478441e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.225182e+07
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.061878e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=6.145588e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=1.050646e+05
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 1.67929]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.399419e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=2.220354e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.138778e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.774589e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.569707e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.482764e+05
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 1.67929]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=9.939784e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.267316e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=9.468652e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.543331e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=4.911372e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=2.34539e+06
fcost_mod=713.245
fcost=2.3461e+06
Wolfe condition 2 fails: stepsize is too small!
#line search 0, alp1=1.000000 alp2=10000000000.000000 alp=2.000000
------------------------------------------------
fg_fwi iter=0: [rhomin,rhomax]=[0.3,1.88001]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 1.88001]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.023720e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=7.836095e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.756818e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.688495e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=4.945535e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=7.909049e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 1.88001]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.567087e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.168331e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.426078e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.174785e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.738975e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 1.88001]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.649469e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.070898e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=4.045394e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=9.089870e-12
isrc=19, fcost=104531, rmse=9.27543
isrc=22, fcost=35614.6, rmse=5.4141
isrc=17, fcost=70055.7, rmse=7.59335
isrc=21, fcost=27633.9, rmse=4.76906
isrc=25, fcost=25890, rmse=4.61612
isrc=2, fcost=44526.7, rmse=6.05371
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=27346.2, rmse=4.74417
isrc=13, fcost=237482, rmse=13.9806
isrc=10, fcost=115545, rmse=9.75184
isrc=7, fcost=107458, rmse=9.4044
isrc=4, fcost=56434.4, rmse=6.81528
isrc=11, fcost=47788.5, rmse=6.27153
isrc=15, fcost=139466, rmse=10.7138
isrc=23, fcost=37538.4, rmse=5.5584
isrc=16, fcost=44068.7, rmse=6.0225
isrc=20, fcost=57078.1, rmse=6.85404
isrc=24, fcost=32570.9, rmse=5.17758
isrc=8, fcost=209839, rmse=13.1418
isrc=5, fcost=37160.6, rmse=5.53035
isrc=18, fcost=106680, rmse=9.37032
isrc=12, fcost=130336, rmse=10.3572
isrc=3, fcost=58973.2, rmse=6.96689
isrc=6, fcost=39481.5, rmse=5.70045
isrc=9, fcost=213583, rmse=13.2585
fcost_dat=2.25995e+06, rmse=8.62563
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=252866, rmse=14.4264
unextended model [rhomin, rhomax]=[0.3, 1.88001]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.835509e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.959694e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=7.587643e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=6.377862e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.210254e+07
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=4.996861e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=6.035601e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=1.029664e+05
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 1.88001]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.240221e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=2.152874e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.083982e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.617319e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.526249e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.412248e+05
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 1.88001]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=9.310973e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.124027e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.980333e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.409608e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=4.717850e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=2.25995e+06
fcost_mod=2852.98
fcost=2.2628e+06
Wolfe condition 2 fails: stepsize is too small!
#line search 1, alp1=2.000000 alp2=10000000000.000000 alp=4.000000
------------------------------------------------
fg_fwi iter=0: [rhomin,rhomax]=[0.3,2.3563]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 2.3563]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.023974e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=7.865675e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.757890e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.693110e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=4.968490e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=7.924337e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 2.3563]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.565297e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.168014e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.422984e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.172108e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.738063e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 2.3563]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.640509e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.069504e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=4.034771e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=9.044773e-12
isrc=22, fcost=29694.6, rmse=4.94369
isrc=19, fcost=95018.2, rmse=8.84332
isrc=17, fcost=60990.8, rmse=7.08507
isrc=25, fcost=22514.2, rmse=4.30467
isrc=21, fcost=23861.7, rmse=4.43162
isrc=2, fcost=37963.6, rmse=5.58979
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=23325.8, rmse=4.38158
isrc=13, fcost=228926, rmse=13.7265
isrc=10, fcost=110607, rmse=9.54122
isrc=7, fcost=98989.3, rmse=9.02622
isrc=4, fcost=49129.7, rmse=6.35893
isrc=11, fcost=41815.9, rmse=5.86655
isrc=15, fcost=135244, rmse=10.5505
isrc=24, fcost=27341.1, rmse=4.74373
isrc=16, fcost=38480.8, rmse=5.62774
isrc=20, fcost=51597.9, rmse=6.5167
isrc=18, fcost=95852, rmse=8.88203
isrc=23, fcost=31485.1, rmse=5.09054
isrc=8, fcost=200378, rmse=12.8421
isrc=5, fcost=32990.2, rmse=5.2108
isrc=12, fcost=122246, rmse=10.0307
isrc=3, fcost=51081.6, rmse=6.48401
isrc=6, fcost=33953.7, rmse=5.28635
isrc=9, fcost=206020, rmse=13.0217
fcost_dat=2.09551e+06, rmse=8.30589
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=245998, rmse=14.2291
unextended model [rhomin, rhomax]=[0.3, 2.3563]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.771216e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.893034e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=7.415371e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=6.162755e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.176740e+07
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=4.854624e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=5.799246e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=9.849686e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 2.3563]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=3.919898e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=2.018508e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=9.733130e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.298909e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.440819e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.275206e+05
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 2.3563]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=8.026514e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=2.837708e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=7.992716e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.140832e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=4.339406e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=2.09551e+06
fcost_mod=11411.9
fcost=2.10692e+06
==========================================================
# iter=1  fk/f0=0.866289
fg_fwi iter=1: [rhomin,rhomax]=[0.3,100]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.035484e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.587792e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.809610e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.942213e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.022376e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.573480e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.567181e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.173715e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.402638e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.131134e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.726419e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.575818e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.041033e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.872084e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.543418e-12
isrc=19, fcost=2.81424e+06, rmse=48.1274
isrc=15, fcost=301958, rmse=15.7647
isrc=22, fcost=1.40135e+06, rmse=33.9614
isrc=24, fcost=737630, rmse=24.6395
isrc=20, fcost=805595, rmse=25.7496
isrc=25, fcost=319029, rmse=16.2042
isrc=2, fcost=1.83127e+06, rmse=38.823
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=619512, rmse=22.5807
isrc=21, fcost=553163, rmse=21.3373
isrc=6, fcost=754114, rmse=24.9132
isrc=10, fcost=1.05123e+06, rmse=29.4144
isrc=4, fcost=2.7879e+06, rmse=47.9016
isrc=11, fcost=891479, rmse=27.0874
isrc=17, fcost=3.43544e+06, rmse=53.1744
isrc=16, fcost=835086, rmse=26.2167
isrc=18, fcost=4.24861e+06, rmse=59.1337
isrc=5, fcost=1.36086e+06, rmse=33.4671
isrc=23, fcost=1.19818e+06, rmse=31.4031
isrc=3, fcost=2.72746e+06, rmse=47.3795
isrc=9, fcost=1.10923e+06, rmse=30.215
isrc=7, fcost=2.89685e+06, rmse=48.8286
isrc=14, fcost=358937, rmse=17.1878
isrc=8, fcost=2.68422e+06, rmse=47.0025
isrc=12, fcost=2.11591e+06, rmse=41.7311
fcost_dat=3.93495e+07, rmse=35.9924
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=13, fcost=1.51022e+06, rmse=35.2559
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=3.321371e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=4.217712e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.586991e+09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.460325e+08
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=2.900693e+07
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.263740e+07
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=1.334223e+06
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=2.678106e+05
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=2.285175e+12
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.028096e+10
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.953634e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.245289e+08
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=7.510652e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.418555e+06
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.232268e+13
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.176492e+10
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.106048e+09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.857044e+08
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=4.319999e+06
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=3.93495e+07
fcost_mod=1.27128e+06
fcost=4.06208e+07
Wolfe condition 1 fails: insufficient misfit decrease!
#line search 0, alp1=0.000000 alp2=1.000000 alp=0.500000
------------------------------------------------
fg_fwi iter=1: [rhomin,rhomax]=[0.3,100]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.030262e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.262367e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.784946e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.823022e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.620286e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.358388e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.563948e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.170434e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.409211e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.147754e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.730351e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.598106e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.058078e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.932501e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.686255e-12
isrc=19, fcost=397010, rmse=18.0764
isrc=15, fcost=87518.2, rmse=8.48713
isrc=22, fcost=160115, rmse=11.4796
isrc=24, fcost=91433.2, rmse=8.67488
isrc=20, fcost=100845, rmse=9.11045
isrc=17, fcost=398663, rmse=18.114
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=75126.8, rmse=7.86338
isrc=25, fcost=39862.3, rmse=5.72787
isrc=2, fcost=215379, rmse=13.3142
isrc=13, fcost=221407, rmse=13.4992
isrc=6, fcost=102135, rmse=9.16851
isrc=21, fcost=64910.6, rmse=7.3092
isrc=10, fcost=132985, rmse=10.462
isrc=7, fcost=490825, rmse=20.099
isrc=4, fcost=305689, rmse=15.8618
isrc=11, fcost=117096, rmse=9.81711
isrc=23, fcost=140533, rmse=10.7548
isrc=16, fcost=105305, rmse=9.30973
isrc=18, fcost=562150, rmse=21.5099
isrc=5, fcost=141435, rmse=10.7892
isrc=3, fcost=320188, rmse=16.2336
isrc=12, fcost=287876, rmse=15.3927
isrc=8, fcost=453863, rmse=19.3274
isrc=9, fcost=139476, rmse=10.7143
fcost_dat=5.28295e+06, rmse=13.188
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=131118, rmse=10.3883
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.163017e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.383014e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=6.156664e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.870717e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.814487e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=3.668054e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=2.969753e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=5.276175e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=7.568944e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.495941e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=2.719741e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=7.016465e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=2.471139e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=4.098909e+05
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=3.817410e+12
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=9.961989e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=3.354383e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=8.778417e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.373183e+06
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=5.28295e+06
fcost_mod=377806
fcost=5.66075e+06
Wolfe condition 1 fails: insufficient misfit decrease!
#line search 1, alp1=0.000000 alp2=0.500000 alp=0.250000
------------------------------------------------
fg_fwi iter=1: [rhomin,rhomax]=[0.3,37.3441]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 37.3441]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.027292e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.070641e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.771676e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.746601e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.258029e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.101302e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 37.3441]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.563844e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.169081e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.415176e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.158845e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.733496e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 37.3441]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.616501e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.063542e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.976919e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.821112e-12
isrc=15, fcost=98366.4, rmse=8.99778
isrc=19, fcost=70703.8, rmse=7.62839
isrc=22, fcost=25666.6, rmse=4.59617
isrc=24, fcost=18429.2, rmse=3.89462
isrc=20, fcost=31698.2, rmse=5.10775
isrc=17, fcost=58720, rmse=6.95192
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=14627.2, rmse=3.46971
isrc=2, fcost=34270.9, rmse=5.31098
isrc=25, fcost=12220.6, rmse=3.17145
isrc=21, fcost=14647, rmse=3.47206
isrc=13, fcost=134450, rmse=10.5194
isrc=10, fcost=66838.9, rmse=7.41697
isrc=6, fcost=19409.7, rmse=3.99688
isrc=7, fcost=76960.2, rmse=7.95875
isrc=4, fcost=43307.5, rmse=5.97026
isrc=11, fcost=24276.1, rmse=4.46994
isrc=23, fcost=24854.6, rmse=4.52288
isrc=16, fcost=22482.4, rmse=4.30163
isrc=18, fcost=88189.2, rmse=8.51961
isrc=5, fcost=25209.9, rmse=4.55509
isrc=8, fcost=130125, rmse=10.3489
isrc=12, fcost=74966.2, rmse=7.85497
isrc=3, fcost=47074.5, rmse=6.2245
isrc=9, fcost=119150, rmse=9.90284
fcost_dat=1.44724e+06, rmse=6.9026
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=170599, rmse=11.8495
unextended model [rhomin, rhomax]=[0.3, 37.3441]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.206254e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.326943e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=5.470468e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=4.182946e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.323569e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=3.452421e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=3.540872e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=5.770921e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 37.3441]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=3.040134e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.646690e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=9.158406e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.643331e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.265193e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.467726e+05
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 37.3441]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.212325e+12
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.468065e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.079719e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.914180e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=5.126305e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=1.44724e+06
fcost_mod=117709
fcost=1.56495e+06
==========================================================
# iter=2  fk/f0=0.643453
fg_fwi iter=2: [rhomin,rhomax]=[0.3,22.9944]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 22.9944]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.027853e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.067994e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.772742e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.743760e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.219539e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.126832e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 22.9944]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.564191e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.170387e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.416035e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.159215e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.734555e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 22.9944]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.612251e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.062560e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.969504e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.759310e-12
isrc=19, fcost=42667, rmse=5.92595
isrc=22, fcost=13598.3, rmse=3.34545
isrc=15, fcost=82533.9, rmse=8.24192
isrc=24, fcost=12986.8, rmse=3.26937
isrc=20, fcost=24986.4, rmse=4.53485
isrc=17, fcost=27862.5, rmse=4.78875
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=10017.6, rmse=2.87139
isrc=2, fcost=16445.2, rmse=3.67901
isrc=25, fcost=10852.2, rmse=2.98863
isrc=13, fcost=115603, rmse=9.75431
isrc=21, fcost=11012.5, rmse=3.01062
isrc=6, fcost=14205.3, rmse=3.4193
isrc=10, fcost=60210.3, rmse=7.03959
isrc=7, fcost=48479.5, rmse=6.31671
isrc=4, fcost=17029.2, rmse=3.74377
isrc=11, fcost=18612.7, rmse=3.91396
isrc=23, fcost=13993.4, rmse=3.3937
isrc=16, fcost=16832.9, rmse=3.72213
isrc=18, fcost=42310.7, rmse=5.90115
isrc=8, fcost=94121.7, rmse=8.8015
isrc=3, fcost=17745.5, rmse=3.82169
isrc=12, fcost=61085.1, rmse=7.09054
isrc=5, fcost=14297.5, rmse=3.43037
isrc=9, fcost=95740.3, rmse=8.87686
fcost_dat=1.02132e+06, rmse=5.79859
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=138088, rmse=10.6608
unextended model [rhomin, rhomax]=[0.3, 22.9944]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.211826e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.355423e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=5.866767e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=4.376207e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.542943e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=3.518667e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=4.013407e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=6.688155e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 22.9944]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=2.307952e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.395707e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=6.789245e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.214297e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.152269e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.000541e+05
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 22.9944]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=8.735680e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=2.923683e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.392270e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.314990e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=4.441582e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=1.02132e+06
fcost_mod=102103
fcost=1.12342e+06
==========================================================
# iter=3  fk/f0=0.46191
fg_fwi iter=3: [rhomin,rhomax]=[0.3,100]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.028716e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.083094e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.775342e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.750276e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.241885e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.166610e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.566436e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.171778e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.418544e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.161081e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.735957e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.615749e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.062297e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.965647e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.707331e-12
isrc=19, fcost=31427.7, rmse=5.0859
isrc=15, fcost=64428, rmse=7.28197
isrc=22, fcost=9947.43, rmse=2.86133
isrc=24, fcost=9033.23, rmse=2.72668
isrc=20, fcost=18659.6, rmse=3.91889
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=8159.51, rmse=2.59146
isrc=17, fcost=21935, rmse=4.24894
isrc=25, fcost=8412.7, rmse=2.63136
isrc=2, fcost=11988.3, rmse=3.14117
isrc=21, fcost=9308.68, rmse=2.76793
isrc=13, fcost=84601, rmse=8.34449
isrc=6, fcost=12180.7, rmse=3.16627
isrc=10, fcost=50751.7, rmse=6.46304
isrc=7, fcost=32695.4, rmse=5.18747
isrc=4, fcost=12861.1, rmse=3.2535
isrc=11, fcost=16095, rmse=3.63964
isrc=23, fcost=10712.5, rmse=2.96932
isrc=16, fcost=15554.9, rmse=3.57804
isrc=18, fcost=34518.3, rmse=5.33011
isrc=8, fcost=65246.2, rmse=7.32807
isrc=12, fcost=45993.5, rmse=6.15262
isrc=5, fcost=10909.8, rmse=2.99654
isrc=3, fcost=13370.3, rmse=3.31728
isrc=9, fcost=77932.5, rmse=8.00887
fcost_dat=770993, rmse=5.0381
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=94270.1, rmse=8.80844
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.115967e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.275089e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=5.537655e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=4.226994e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.131472e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=3.436599e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=3.885060e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=6.513335e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=2.216613e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.370348e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=6.878449e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.205598e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.146600e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.002841e+05
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=7.397090e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=2.747787e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=7.259416e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.048440e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=4.146085e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=770993
fcost_mod=106450
fcost=877443
==========================================================
# iter=4  fk/f0=0.360773
fg_fwi iter=4: [rhomin,rhomax]=[0.3,100]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.029010e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.043122e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.774121e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.745807e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.212686e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.135393e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.571903e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172708e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.424999e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.169782e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.739310e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.638715e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.063985e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.983651e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.724107e-12
isrc=19, fcost=17978.6, rmse=3.84672
isrc=15, fcost=43245.1, rmse=5.96596
isrc=22, fcost=10467.7, rmse=2.93519
isrc=20, fcost=11862.9, rmse=3.1247
isrc=17, fcost=12407, rmse=3.19554
isrc=2, fcost=8975.22, rmse=2.71791
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=8873.79, rmse=2.7025
isrc=21, fcost=10157.5, rmse=2.89138
isrc=6, fcost=9673.11, rmse=2.8216
isrc=13, fcost=137308, rmse=10.6307
isrc=25, fcost=8306.09, rmse=2.61463
isrc=10, fcost=23597.7, rmse=4.40704
isrc=4, fcost=11711, rmse=3.10462
isrc=7, fcost=16678.9, rmse=3.70506
isrc=11, fcost=12717.3, rmse=3.23527
isrc=23, fcost=12334.1, rmse=3.18614
isrc=16, fcost=13576.2, rmse=3.34273
isrc=24, fcost=10162.4, rmse=2.89208
isrc=18, fcost=18737.2, rmse=3.92703
isrc=8, fcost=69681, rmse=7.57302
isrc=5, fcost=9734.48, rmse=2.83053
isrc=3, fcost=11057.4, rmse=3.01674
isrc=12, fcost=25172.7, rmse=4.55173
isrc=9, fcost=77030.7, rmse=7.96239
fcost_dat=758045, rmse=4.99562
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=166598, rmse=11.7097
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.129243e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.283002e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=5.209511e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=4.495488e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=9.000643e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=3.865274e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=4.004524e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=6.825776e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=2.427872e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.452549e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=7.342814e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.348008e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.188190e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.085084e+05
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=5.953510e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=2.228826e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=5.673697e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.598663e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.455289e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=758045
fcost_mod=88309.9
fcost=846354
==========================================================
# iter=5  fk/f0=0.347991
fg_fwi iter=5: [rhomin,rhomax]=[0.3,28.1283]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 28.1283]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.028548e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.017360e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.771992e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.741189e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.195932e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.091364e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 28.1283]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.573295e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172192e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.426330e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.172134e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.739671e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 28.1283]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.649099e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.066224e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.995371e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.780907e-12
isrc=19, fcost=18902.5, rmse=3.94432
isrc=15, fcost=34499.6, rmse=5.32867
isrc=22, fcost=12079.5, rmse=3.15309
isrc=17, fcost=15512.9, rmse=3.5732
isrc=2, fcost=11809.9, rmse=3.1177
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=10325.4, rmse=2.91518
isrc=25, fcost=9695.65, rmse=2.82488
isrc=21, fcost=11249.6, rmse=3.04285
isrc=6, fcost=12074, rmse=3.15238
isrc=10, fcost=34133.6, rmse=5.30033
isrc=13, fcost=47581.1, rmse=6.2579
isrc=7, fcost=21782.2, rmse=4.23412
isrc=4, fcost=12212.3, rmse=3.17038
isrc=11, fcost=15420.6, rmse=3.56256
isrc=16, fcost=15060.1, rmse=3.52068
isrc=23, fcost=13814.6, rmse=3.37195
isrc=24, fcost=11883.7, rmse=3.12743
isrc=20, fcost=14722.3, rmse=3.48096
isrc=18, fcost=20348, rmse=4.09235
isrc=8, fcost=40710.6, rmse=5.7885
isrc=5, fcost=11519.2, rmse=3.07909
isrc=3, fcost=12892.5, rmse=3.25746
isrc=9, fcost=41523.8, rmse=5.84602
isrc=12, fcost=38385.1, rmse=5.62074
fcost_dat=536746, rmse=4.20365
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=48607.2, rmse=6.32503
unextended model [rhomin, rhomax]=[0.3, 28.1283]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.182175e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.330526e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=5.412726e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=4.543278e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=9.068518e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=3.802951e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=4.020276e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=6.788573e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 28.1283]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=2.522864e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.489115e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=6.939742e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.379986e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.199330e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=9.830221e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 28.1283]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=6.795522e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=2.457507e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=6.599046e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.801148e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.776214e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=536746
fcost_mod=55145.8
fcost=591892
==========================================================
# iter=6  fk/f0=0.243365
fg_fwi iter=6: [rhomin,rhomax]=[0.3,51.1735]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 51.1735]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.029314e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.083149e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.776188e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.759779e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.287948e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.171937e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 51.1735]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.572242e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172331e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.423552e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.168342e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.738544e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 51.1735]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.639572e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.062983e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.978827e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.722957e-12
isrc=19, fcost=15460.6, rmse=3.56718
isrc=22, fcost=6878.16, rmse=2.37929
isrc=15, fcost=26082.9, rmse=4.6333
isrc=17, fcost=10527.9, rmse=2.94363
isrc=20, fcost=9416.32, rmse=2.78389
isrc=2, fcost=6954.94, rmse=2.39254
isrc=25, fcost=6191.91, rmse=2.25748
isrc=13, fcost=37409.9, rmse=5.54888
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=6090.25, rmse=2.23887
isrc=21, fcost=6998.84, rmse=2.40008
isrc=6, fcost=6901.87, rmse=2.38339
isrc=10, fcost=18946.2, rmse=3.94888
isrc=4, fcost=7448.06, rmse=2.4759
isrc=11, fcost=9343.83, rmse=2.77316
isrc=7, fcost=16787.1, rmse=3.71706
isrc=23, fcost=8207.5, rmse=2.59907
isrc=24, fcost=6464.61, rmse=2.30666
isrc=16, fcost=9452.72, rmse=2.78927
isrc=18, fcost=17276, rmse=3.7708
isrc=8, fcost=33615.3, rmse=5.25994
isrc=5, fcost=7095.18, rmse=2.41654
isrc=12, fcost=19568.6, rmse=4.01321
isrc=3, fcost=8287.67, rmse=2.61173
isrc=9, fcost=27004.1, rmse=4.7144
fcost_dat=368718, rmse=3.48409
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=40307.6, rmse=5.75977
unextended model [rhomin, rhomax]=[0.3, 51.1735]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.019716e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.157166e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.703860e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=4.030362e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.061071e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=3.376175e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=3.479808e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=5.915325e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 51.1735]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.995860e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.309105e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=5.754874e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.040816e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.114918e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=8.445190e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 51.1735]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.511854e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.999116e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.711621e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.366851e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.207582e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=368718
fcost_mod=49925.4
fcost=418643
==========================================================
# iter=7  fk/f0=0.172131
fg_fwi iter=7: [rhomin,rhomax]=[0.3,100]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.029877e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.153444e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.779037e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.781797e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.380994e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.241875e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.571645e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172042e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.420629e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.165903e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.737644e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.634202e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.059900e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.968126e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.701186e-12
isrc=19, fcost=9559.46, rmse=2.80497
isrc=15, fcost=16730.5, rmse=3.71079
isrc=22, fcost=5933.29, rmse=2.20983
isrc=17, fcost=9018.34, rmse=2.72443
isrc=20, fcost=7328.84, rmse=2.45601
isrc=2, fcost=5512.38, rmse=2.13001
isrc=25, fcost=5342.93, rmse=2.09701
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=4932.08, rmse=2.01478
isrc=10, fcost=15811.1, rmse=3.60739
isrc=6, fcost=5660.97, rmse=2.15853
isrc=13, fcost=28778.3, rmse=4.86681
isrc=21, fcost=5400.09, rmse=2.1082
isrc=7, fcost=12672.1, rmse=3.22951
isrc=4, fcost=7311.61, rmse=2.45312
isrc=11, fcost=7720.88, rmse=2.52084
isrc=23, fcost=6411, rmse=2.29707
isrc=24, fcost=5173.06, rmse=2.06341
isrc=16, fcost=7704.19, rmse=2.51811
isrc=18, fcost=12081.7, rmse=3.15338
isrc=8, fcost=29963.1, rmse=4.96598
isrc=5, fcost=6068.17, rmse=2.23481
isrc=12, fcost=13177, rmse=3.29322
isrc=3, fcost=6924.06, rmse=2.38722
isrc=9, fcost=36352.4, rmse=5.46989
fcost_dat=304932, rmse=3.16842
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=33364.3, rmse=5.24026
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=9.279535e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.047823e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.175993e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.805649e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.040812e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=3.339631e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=3.187161e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=5.860043e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.929518e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.287757e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=6.130928e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.118889e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.123752e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=9.088955e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.654478e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.981540e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.933469e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.432002e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.237228e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=304932
fcost_mod=43360.5
fcost=348292
==========================================================
# iter=8  fk/f0=0.143205
fg_fwi iter=8: [rhomin,rhomax]=[0.3,100]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.030112e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.197921e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.780690e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.797323e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.442385e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.285725e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.571109e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.171885e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.419122e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.164729e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.737166e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.630780e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.058247e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.963221e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.694134e-12
isrc=19, fcost=8379.08, rmse=2.62609
isrc=22, fcost=5681.89, rmse=2.16251
isrc=15, fcost=14400.5, rmse=3.44271
isrc=24, fcost=5380.41, rmse=2.10436
isrc=20, fcost=6469.6, rmse=2.30755
isrc=17, fcost=7509.13, rmse=2.48603
isrc=25, fcost=5157.22, rmse=2.06025
isrc=13, fcost=23294, rmse=4.37858
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=4574.27, rmse=1.94032
isrc=6, fcost=5077.99, rmse=2.04436
isrc=2, fcost=5409.12, rmse=2.10996
isrc=21, fcost=5097.43, rmse=2.04827
isrc=10, fcost=11675.1, rmse=3.09986
isrc=7, fcost=10302.4, rmse=2.91194
isrc=11, fcost=6988.47, rmse=2.3983
isrc=4, fcost=5794.61, rmse=2.18385
isrc=23, fcost=6260.65, rmse=2.26998
isrc=16, fcost=6985, rmse=2.3977
isrc=18, fcost=9900.45, rmse=2.85456
isrc=8, fcost=16137.1, rmse=3.64438
isrc=5, fcost=5539.98, rmse=2.13534
isrc=12, fcost=11583.4, rmse=3.08766
isrc=3, fcost=5813.25, rmse=2.18737
isrc=9, fcost=17642.5, rmse=3.81059
fcost_dat=235354, rmse=2.78357
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=24300.2, rmse=4.47215
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=8.576708e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=9.722270e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=3.885746e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.523078e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=7.521742e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=3.111499e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=2.969584e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=5.584310e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.922006e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.287115e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=6.319719e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.157755e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.130720e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=9.266999e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=5.038937e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=2.034681e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=5.250627e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.507953e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.310100e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=235354
fcost_mod=38113.3
fcost=273467
==========================================================
# iter=9  fk/f0=0.11244
fg_fwi iter=9: [rhomin,rhomax]=[0.3,100]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.030396e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.236679e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.782295e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.810601e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.494129e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.327520e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.571721e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172038e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.419291e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.165206e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.737267e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.632035e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.057157e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.961321e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.688180e-12
isrc=19, fcost=7568.57, rmse=2.49585
isrc=22, fcost=4158.59, rmse=1.85006
isrc=15, fcost=11460.2, rmse=3.07119
isrc=17, fcost=5411.34, rmse=2.1104
isrc=25, fcost=4132.11, rmse=1.84416
isrc=2, fcost=4188.33, rmse=1.85666
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=3699.65, rmse=1.74499
isrc=6, fcost=4135.46, rmse=1.84491
isrc=13, fcost=16689.8, rmse=3.70627
isrc=10, fcost=10221.6, rmse=2.90049
isrc=21, fcost=4336.1, rmse=1.88913
isrc=4, fcost=4465.31, rmse=1.91707
isrc=7, fcost=7767.1, rmse=2.52837
isrc=23, fcost=5033.9, rmse=2.03547
isrc=11, fcost=5788.74, rmse=2.18275
isrc=24, fcost=4191.54, rmse=1.85737
isrc=16, fcost=5857.37, rmse=2.19565
isrc=20, fcost=5114.15, rmse=2.05163
isrc=18, fcost=9171.5, rmse=2.74746
isrc=5, fcost=4454.94, rmse=1.91484
isrc=8, fcost=15035.9, rmse=3.51784
isrc=12, fcost=8477.12, rmse=2.64141
isrc=3, fcost=4953.48, rmse=2.01914
isrc=9, fcost=13383.9, rmse=3.31897
fcost_dat=187489, rmse=2.48445
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=17792.2, rmse=3.82672
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=7.877410e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=8.910006e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=3.534861e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.282676e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=7.112887e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=2.994388e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=2.896151e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=5.769611e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.767627e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.240112e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=5.692527e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.989852e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.094587e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=8.082810e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.330767e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.955570e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.664065e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.362968e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.186848e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=187489
fcost_mod=54528.3
fcost=242017
==========================================================
# iter=10  fk/f0=0.0995088
fg_fwi iter=10: [rhomin,rhomax]=[0.3,100]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.030964e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.299250e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.784798e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.830719e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.577699e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.400706e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.573582e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172422e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.420635e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.166350e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.737376e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.637322e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.057317e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.958038e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.677583e-12
isrc=19, fcost=8068.56, rmse=2.57697
isrc=22, fcost=4404.86, rmse=1.90405
isrc=17, fcost=4990.59, rmse=2.02669
isrc=15, fcost=8685.76, rmse=2.67372
isrc=25, fcost=4165.46, rmse=1.85158
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=3773.05, rmse=1.76221
isrc=2, fcost=4455.56, rmse=1.91497
isrc=13, fcost=13435.8, rmse=3.3254
isrc=21, fcost=4209.66, rmse=1.86138
isrc=6, fcost=3496.56, rmse=1.69641
isrc=10, fcost=7042.13, rmse=2.40749
isrc=4, fcost=3928.01, rmse=1.79803
isrc=11, fcost=4421.39, rmse=1.90762
isrc=7, fcost=13378.4, rmse=3.31829
isrc=23, fcost=4999.18, rmse=2.02843
isrc=24, fcost=4559.39, rmse=1.93716
isrc=16, fcost=4753.77, rmse=1.97802
isrc=20, fcost=5119.54, rmse=2.05271
isrc=18, fcost=8511.64, rmse=2.64678
isrc=8, fcost=16910.7, rmse=3.73073
isrc=5, fcost=3720.7, rmse=1.74994
isrc=3, fcost=4580.93, rmse=1.94173
isrc=12, fcost=7838.68, rmse=2.54
isrc=9, fcost=12753.8, rmse=3.2399
fcost_dat=176634, rmse=2.41145
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=14429.7, rmse=3.44619
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=7.238146e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=7.962451e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=2.981348e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.127494e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=7.022767e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=3.039541e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=3.171085e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=7.791052e+04
icycle=8, [scx,scy,scz]=[2,2,1]
rnorm=3.507664e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.985825e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.297070e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=6.238770e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.024808e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.100807e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=9.187783e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.835901e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=2.056874e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.993354e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.423421e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.290343e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=176634
fcost_mod=152497
fcost=329130
Wolfe condition 1 fails: insufficient misfit decrease!
#line search 0, alp1=0.000000 alp2=1.000000 alp=0.500000
------------------------------------------------
fg_fwi iter=10: [rhomin,rhomax]=[0.3,100]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.030688e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.269694e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.783617e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.820931e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.535046e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.363088e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.572642e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172231e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.419947e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.165766e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.737316e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.634614e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.057060e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.959649e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.682877e-12
isrc=19, fcost=7197.47, rmse=2.4339
isrc=22, fcost=3786.35, rmse=1.76532
isrc=15, fcost=9372.82, rmse=2.77745
isrc=17, fcost=4786.76, rmse=1.98487
isrc=25, fcost=3797.15, rmse=1.76783
isrc=13, fcost=13949.1, rmse=3.38833
isrc=2, fcost=3752.72, rmse=1.75746
isrc=21, fcost=4039.25, rmse=1.82332
isrc=7, fcost=9026.01, rmse=2.72559
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=3507.77, rmse=1.69913
isrc=10, fcost=8029.89, rmse=2.57079
isrc=6, fcost=3648.17, rmse=1.7328
isrc=4, fcost=3844.11, rmse=1.77873
isrc=23, fcost=4485.29, rmse=1.92135
isrc=11, fcost=4924.94, rmse=2.01332
isrc=16, fcost=5112.62, rmse=2.05132
isrc=24, fcost=3771.2, rmse=1.76178
isrc=20, fcost=4760.24, rmse=1.97937
isrc=8, fcost=14170.9, rmse=3.41516
isrc=18, fcost=8428.64, rmse=2.63385
isrc=12, fcost=7443.93, rmse=2.47522
isrc=5, fcost=3859.09, rmse=1.78219
isrc=9, fcost=11628.1, rmse=3.09362
isrc=3, fcost=4260.7, rmse=1.87263
fcost_dat=166452, rmse=2.34092
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=14869, rmse=3.49826
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=7.515594e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=8.402506e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=3.242641e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.187147e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=7.020721e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=2.995708e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=2.985923e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=6.562834e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.798802e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.245289e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=5.688950e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.946286e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.085289e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=8.135986e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.314405e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.969724e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.611718e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.342970e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.188386e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=166452
fcost_mod=48995.3
fcost=215448
==========================================================
# iter=11  fk/f0=0.0885844
fg_fwi iter=11: [rhomin,rhomax]=[0.3,100]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.031523e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.388810e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.787224e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.873185e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.704965e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.478973e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.575056e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172232e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.420624e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.165506e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.736553e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.641582e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.056604e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.951800e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.679095e-12
isrc=22, fcost=3217.93, rmse=1.62742
isrc=19, fcost=8388.08, rmse=2.6275
isrc=15, fcost=9643, rmse=2.8172
isrc=17, fcost=8199.89, rmse=2.59786
isrc=25, fcost=3102.29, rmse=1.59791
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=2766.33, rmse=1.50891
isrc=2, fcost=4803.19, rmse=1.98828
isrc=21, fcost=2767.2, rmse=1.50915
isrc=10, fcost=18273.7, rmse=3.87815
isrc=6, fcost=3253.87, rmse=1.63648
isrc=7, fcost=11661.6, rmse=3.09807
isrc=4, fcost=5721.16, rmse=2.16997
isrc=11, fcost=4376.35, rmse=1.89788
isrc=16, fcost=3876.29, rmse=1.78616
isrc=23, fcost=4420.37, rmse=1.9074
isrc=20, fcost=5699, rmse=2.16576
isrc=24, fcost=3898.86, rmse=1.79135
isrc=18, fcost=9712, rmse=2.82726
isrc=8, fcost=13228.2, rmse=3.29961
isrc=5, fcost=3990.63, rmse=1.81231
isrc=3, fcost=6359.01, rmse=2.28774
isrc=12, fcost=8412, rmse=2.63125
isrc=13, fcost=12036.8, rmse=3.14751
isrc=14, fcost=11046.6, rmse=3.01527
fcost_dat=192651, rmse=2.51841
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=9, fcost=23796.4, rmse=4.42555
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=6.666435e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=7.348004e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=2.588627e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.927625e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=6.937931e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=2.978796e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=3.253080e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=9.442986e+04
icycle=8, [scx,scy,scz]=[2,2,1]
rnorm=4.213369e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.556803e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.186689e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.939249e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.825723e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.066455e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.989112e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.524333e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=2.006751e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.929545e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.400762e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.272739e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=192651
fcost_mod=67281.5
fcost=259932
Wolfe condition 1 fails: insufficient misfit decrease!
#line search 0, alp1=0.000000 alp2=1.000000 alp=0.500000
------------------------------------------------
fg_fwi iter=11: [rhomin,rhomax]=[0.3,100]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.031113e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.330477e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.785541e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.846122e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.618979e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.421038e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.573834e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172229e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.420286e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.165640e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.736914e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.637997e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.057045e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.955710e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.680749e-12
isrc=22, fcost=3306.3, rmse=1.64962
isrc=19, fcost=5421.08, rmse=2.1123
isrc=15, fcost=8046.58, rmse=2.57346
isrc=17, fcost=5097.75, rmse=2.04833
isrc=25, fcost=3283.28, rmse=1.64386
isrc=2, fcost=3849.09, rmse=1.77988
isrc=13, fcost=9777.94, rmse=2.83684
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=3040.04, rmse=1.5818
isrc=10, fcost=8094.21, rmse=2.58107
isrc=21, fcost=3231.23, rmse=1.63078
isrc=6, fcost=3159.68, rmse=1.61262
isrc=4, fcost=3635.85, rmse=1.72988
isrc=7, fcost=6008.58, rmse=2.22381
isrc=11, fcost=4056.48, rmse=1.8272
isrc=23, fcost=4001.4, rmse=1.81476
isrc=16, fcost=3839.81, rmse=1.77773
isrc=24, fcost=3447.83, rmse=1.68455
isrc=20, fcost=4219.25, rmse=1.8635
isrc=8, fcost=9034.99, rmse=2.72694
isrc=5, fcost=3307.28, rmse=1.64986
isrc=18, fcost=6232.82, rmse=2.26493
isrc=3, fcost=4318.95, rmse=1.88539
isrc=9, fcost=11532.9, rmse=3.08093
isrc=12, fcost=6519.08, rmse=2.31635
fcost_dat=136808, rmse=2.12225
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=10345.2, rmse=2.91798
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=7.074671e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=7.856710e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=2.899173e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.049442e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=6.944672e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=2.965407e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=3.048034e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=7.712632e+04
icycle=8, [scx,scy,scz]=[2,2,1]
rnorm=3.426667e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.638861e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.205006e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=5.185690e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.860259e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.070732e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=7.331313e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.371796e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.978573e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.735952e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.363675e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.219136e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=136808
fcost_mod=41383
fcost=178191
==========================================================
# iter=12  fk/f0=0.0732657
fg_fwi iter=12: [rhomin,rhomax]=[0.3,100]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.031284e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.383419e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.787177e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.877964e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.715830e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.468841e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.573834e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.171969e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.419703e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.164796e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.736374e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.637497e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.056676e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.952803e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.686432e-12
isrc=19, fcost=5376.47, rmse=2.10359
isrc=22, fcost=3023.77, rmse=1.57756
isrc=15, fcost=6730.97, rmse=2.3537
isrc=17, fcost=4289.15, rmse=1.87887
isrc=25, fcost=2967.19, rmse=1.56273
isrc=2, fcost=3162.45, rmse=1.61333
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=2836.72, rmse=1.52799
isrc=21, fcost=3052.77, rmse=1.58511
isrc=10, fcost=5462.8, rmse=2.12041
isrc=6, fcost=2984.14, rmse=1.56719
isrc=4, fcost=3098.04, rmse=1.59682
isrc=11, fcost=3808.38, rmse=1.77044
isrc=7, fcost=4762.17, rmse=1.97977
isrc=23, fcost=3362.28, rmse=1.66352
isrc=24, fcost=2973.15, rmse=1.5643
isrc=16, fcost=3710.65, rmse=1.74758
isrc=20, fcost=4044, rmse=1.82439
isrc=18, fcost=5252.86, rmse=2.07926
isrc=5, fcost=2971.04, rmse=1.56375
isrc=8, fcost=8883.76, rmse=2.70402
isrc=12, fcost=6156.43, rmse=2.251
isrc=3, fcost=3627.29, rmse=1.72784
isrc=9, fcost=7691.8, rmse=2.51609
isrc=13, fcost=11677.8, rmse=3.10022
fcost_dat=122851, rmse=2.01109
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=10945, rmse=3.00137
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=6.380878e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=7.111905e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=2.624926e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.684557e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=6.329169e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=2.711824e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=2.785325e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=7.602273e+04
icycle=8, [scx,scy,scz]=[2,2,1]
rnorm=3.434323e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.652102e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.209634e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=5.454670e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.943081e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.088736e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=7.908682e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.560261e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.982715e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.941909e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.418838e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.263396e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=122851
fcost_mod=31040.9
fcost=153892
==========================================================
# iter=13  fk/f0=0.0632749
fg_fwi iter=13: [rhomin,rhomax]=[0.3,100]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.031266e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.379164e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.787200e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.876256e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.704570e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.461367e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.573917e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172036e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.420380e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.164969e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.736399e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.637884e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.056661e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.953708e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.689790e-12
isrc=19, fcost=4855.53, rmse=1.99908
isrc=22, fcost=2997.64, rmse=1.57073
isrc=15, fcost=6510.1, rmse=2.31476
isrc=17, fcost=3925.92, rmse=1.79756
isrc=25, fcost=2969.21, rmse=1.56326
isrc=13, fcost=7676.28, rmse=2.51355
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=2743.26, rmse=1.50261
isrc=2, fcost=3446.82, rmse=1.68431
isrc=21, fcost=3050.98, rmse=1.58464
isrc=6, fcost=2746.55, rmse=1.50351
isrc=10, fcost=4979.96, rmse=2.02453
isrc=4, fcost=2805.82, rmse=1.51964
isrc=7, fcost=4613.3, rmse=1.94858
isrc=11, fcost=3570.96, rmse=1.71437
isrc=23, fcost=3395.72, rmse=1.67178
isrc=16, fcost=3518.6, rmse=1.70176
isrc=24, fcost=2944.84, rmse=1.55684
isrc=20, fcost=3358.92, rmse=1.66269
isrc=18, fcost=5009.83, rmse=2.0306
isrc=8, fcost=8182.99, rmse=2.59518
isrc=5, fcost=2894.94, rmse=1.54359
isrc=12, fcost=5460.01, rmse=2.11987
isrc=3, fcost=3551.28, rmse=1.70964
isrc=9, fcost=6874.9, rmse=2.37873
fcost_dat=110631, rmse=1.90845
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=8546.74, rmse=2.65224
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=6.379126e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=7.133174e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=2.677472e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.635387e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=6.166712e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=2.641137e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=2.583417e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=6.554925e+04
icycle=8, [scx,scy,scz]=[2,2,1]
rnorm=2.967712e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.621975e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.197611e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=5.303079e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.905187e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.079983e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=7.701198e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.434962e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.960668e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.836286e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.391651e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.230260e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=110631
fcost_mod=19625.1
fcost=130256
==========================================================
# iter=14  fk/f0=0.0535567
fg_fwi iter=14: [rhomin,rhomax]=[0.3,100]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.031418e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.387649e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.787662e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.875248e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.699257e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.471137e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.574540e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172285e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.421445e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.165524e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.736553e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.639529e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.056591e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.953180e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.686440e-12
isrc=19, fcost=4293.02, rmse=1.87972
isrc=22, fcost=2672.57, rmse=1.48312
isrc=15, fcost=5370.42, rmse=2.1024
isrc=17, fcost=3506.47, rmse=1.69882
isrc=25, fcost=2675.06, rmse=1.48381
isrc=2, fcost=2718.91, rmse=1.49592
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=2479.51, rmse=1.42855
isrc=6, fcost=2557.57, rmse=1.45086
isrc=21, fcost=2697.06, rmse=1.4899
isrc=10, fcost=4539.03, rmse=1.93283
isrc=7, fcost=4548.7, rmse=1.93489
isrc=11, fcost=3259.01, rmse=1.63778
isrc=4, fcost=2670.26, rmse=1.48248
isrc=23, fcost=3034.75, rmse=1.58042
isrc=16, fcost=3106.71, rmse=1.59905
isrc=20, fcost=3008.45, rmse=1.57356
isrc=24, fcost=2574.69, rmse=1.45571
isrc=18, fcost=4632.77, rmse=1.95269
isrc=8, fcost=7111.04, rmse=2.41924
isrc=12, fcost=4769.37, rmse=1.98126
isrc=5, fcost=2672.54, rmse=1.48311
isrc=3, fcost=3018.71, rmse=1.57624
isrc=13, fcost=7201.31, rmse=2.43454
isrc=9, fcost=5979.84, rmse=2.21849
fcost_dat=98549.5, rmse=1.80123
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=7451.73, rmse=2.47651
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=6.307705e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.963409e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=2.546674e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.635646e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=6.132246e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=2.639626e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=2.719479e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=7.170146e+04
icycle=8, [scx,scy,scz]=[2,2,1]
rnorm=3.231859e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.520190e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.169746e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.808308e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.804245e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.059424e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.840116e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.190715e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.938166e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.650415e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.334878e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.179137e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=98549.5
fcost_mod=16358.3
fcost=114908
==========================================================
# iter=15  fk/f0=0.047246
fg_fwi iter=15: [rhomin,rhomax]=[0.3,100]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.031674e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.421764e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.788690e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.887342e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.727638e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.500972e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.575318e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172462e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.422422e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.165883e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.736566e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.641246e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.056090e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.951010e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.684201e-12
isrc=19, fcost=3563.15, rmse=1.71249
isrc=22, fcost=2434.41, rmse=1.4155
isrc=15, fcost=4598.39, rmse=1.94543
isrc=17, fcost=3214.89, rmse=1.62665
isrc=25, fcost=2446.35, rmse=1.41896
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=2314.88, rmse=1.38031
isrc=2, fcost=2592.39, rmse=1.4607
isrc=21, fcost=2369.02, rmse=1.39636
isrc=10, fcost=3802.71, rmse=1.76912
isrc=6, fcost=2320.18, rmse=1.38189
isrc=4, fcost=2671.8, rmse=1.48291
isrc=7, fcost=3668.6, rmse=1.73765
isrc=11, fcost=2888.68, rmse=1.54192
isrc=23, fcost=2704.18, rmse=1.49186
isrc=24, fcost=2342.77, rmse=1.3886
isrc=16, fcost=2604.74, rmse=1.46418
isrc=20, fcost=2699.82, rmse=1.49066
isrc=8, fcost=5500.68, rmse=2.12775
isrc=18, fcost=4026.76, rmse=1.8205
isrc=12, fcost=4168.19, rmse=1.85219
isrc=5, fcost=2467.79, rmse=1.42517
isrc=3, fcost=3025.64, rmse=1.57805
isrc=9, fcost=5240.65, rmse=2.07685
isrc=13, fcost=6507.37, rmse=2.31427
fcost_dat=86112.9, rmse=1.68374
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=5938.82, rmse=2.21086
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=6.077623e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.640611e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=2.347353e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.522155e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=5.839277e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=2.510677e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=2.663870e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=7.200975e+04
icycle=8, [scx,scy,scz]=[2,2,1]
rnorm=3.237108e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.483290e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.160369e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.613563e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.773420e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.054688e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.587281e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.156408e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.933476e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.638166e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.326017e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.171113e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=86112.9
fcost_mod=14417.7
fcost=100531
==========================================================
# iter=16  fk/f0=0.0413346
fg_fwi iter=16: [rhomin,rhomax]=[0.3,100]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.032096e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.502631e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.790603e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.926980e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.820434e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.573079e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.576804e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172643e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.423826e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.166552e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.736582e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.644531e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.054866e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.947122e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.683827e-12
isrc=19, fcost=3364.41, rmse=1.66405
isrc=22, fcost=2102.59, rmse=1.3155
isrc=15, fcost=4135.81, rmse=1.84498
isrc=17, fcost=2885.3, rmse=1.54102
isrc=25, fcost=2070.81, rmse=1.30552
isrc=21, fcost=1994.7, rmse=1.2813
isrc=2, fcost=2233.79, rmse=1.35592
isrc=6, fcost=2097.15, rmse=1.31379
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=1981.1, rmse=1.27692
isrc=10, fcost=4320.34, rmse=1.88569
isrc=7, fcost=3113.1, rmse=1.60069
isrc=11, fcost=2601.16, rmse=1.46317
isrc=4, fcost=2410.12, rmse=1.40842
isrc=23, fcost=2331.77, rmse=1.38534
isrc=16, fcost=2254.94, rmse=1.36232
isrc=20, fcost=2604.47, rmse=1.4641
isrc=24, fcost=2063.76, rmse=1.30329
isrc=18, fcost=3587.83, rmse=1.71841
isrc=12, fcost=3466.55, rmse=1.68912
isrc=5, fcost=2330.29, rmse=1.3849
isrc=3, fcost=2919.73, rmse=1.55018
isrc=13, fcost=6675.05, rmse=2.3439
isrc=8, fcost=8012.13, rmse=2.56795
isrc=9, fcost=6340.32, rmse=2.28438
fcost_dat=84251, rmse=1.66544
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=6353.76, rmse=2.28679
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=5.372309e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=5.777056e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.920209e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.216228e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=5.238064e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=2.280280e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=2.575084e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=7.506803e+04
icycle=8, [scx,scy,scz]=[2,2,1]
rnorm=3.431914e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.459783e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.153716e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.430325e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.756247e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.053270e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.309321e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.113864e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.924697e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.657044e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.329277e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.179332e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=84251
fcost_mod=14709
fcost=98960
==========================================================
# iter=17  fk/f0=0.0406888
fg_fwi iter=17: [rhomin,rhomax]=[0.3,92.3647]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 92.3647]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.032053e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.500617e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.790448e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.926072e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.815598e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.565564e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 92.3647]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.576890e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172661e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.424062e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.166901e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.736740e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 92.3647]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.645025e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.055029e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.947977e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.684240e-12
isrc=19, fcost=3044.47, rmse=1.58295
isrc=15, fcost=3666.22, rmse=1.73708
isrc=22, fcost=2053.38, rmse=1.30001
isrc=17, fcost=2506.22, rmse=1.43622
isrc=21, fcost=1994.5, rmse=1.28123
isrc=25, fcost=2078.09, rmse=1.30781
isrc=2, fcost=2200.24, rmse=1.3457
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=1961.08, rmse=1.27046
isrc=6, fcost=2019.15, rmse=1.28913
isrc=10, fcost=3010.12, rmse=1.574
isrc=4, fcost=2286.4, rmse=1.37179
isrc=7, fcost=2901.09, rmse=1.54523
isrc=16, fcost=2166.36, rmse=1.33529
isrc=23, fcost=2281.57, rmse=1.37034
isrc=11, fcost=2443.94, rmse=1.41826
isrc=24, fcost=2039.45, rmse=1.29559
isrc=20, fcost=2335.23, rmse=1.38636
isrc=18, fcost=3303.28, rmse=1.64886
isrc=8, fcost=4410.02, rmse=1.90516
isrc=5, fcost=2237.17, rmse=1.35694
isrc=3, fcost=2552.61, rmse=1.44945
isrc=12, fcost=3090, rmse=1.59475
isrc=13, fcost=4655.61, rmse=1.95749
isrc=9, fcost=4143.9, rmse=1.84678
fcost_dat=69979.8, rmse=1.51785
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=4599.76, rmse=1.94572
unextended model [rhomin, rhomax]=[0.3, 92.3647]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=5.364815e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=5.809783e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.958576e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.186597e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=5.157506e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=2.253162e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=2.411420e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=6.849853e+04
icycle=8, [scx,scy,scz]=[2,2,1]
rnorm=3.136816e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 92.3647]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.452823e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.151713e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.402899e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.754473e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.052965e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.266438e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 92.3647]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.109262e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.924108e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.661301e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.330034e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.180576e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=69979.8
fcost_mod=10990.6
fcost=80970.4
==========================================================
# iter=18  fk/f0=0.0332921
fg_fwi iter=18: [rhomin,rhomax]=[0.3,90.3451]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 90.3451]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.032090e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.513541e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.790574e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.932055e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.827057e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.573446e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 90.3451]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.577233e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172701e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.424387e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.167292e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.736879e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 90.3451]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.646039e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.054916e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.947933e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.684149e-12
isrc=19, fcost=2957.11, rmse=1.56007
isrc=15, fcost=3545.09, rmse=1.70815
isrc=17, fcost=2385.21, rmse=1.40112
isrc=25, fcost=2043.64, rmse=1.29692
isrc=21, fcost=1946.15, rmse=1.26561
isrc=22, fcost=1996.52, rmse=1.28188
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=1916.79, rmse=1.25603
isrc=2, fcost=2163.6, rmse=1.33444
isrc=10, fcost=2912.97, rmse=1.54839
isrc=6, fcost=1965.77, rmse=1.27198
isrc=7, fcost=2794.5, rmse=1.51658
isrc=11, fcost=2365.7, rmse=1.39538
isrc=4, fcost=2244.95, rmse=1.3593
isrc=23, fcost=2222.04, rmse=1.35235
isrc=16, fcost=2097.45, rmse=1.31389
isrc=20, fcost=2277.58, rmse=1.36914
isrc=24, fcost=1987.78, rmse=1.27907
isrc=18, fcost=3097.07, rmse=1.59657
isrc=3, fcost=2499.04, rmse=1.43416
isrc=12, fcost=2928.93, rmse=1.55263
isrc=5, fcost=2187.4, rmse=1.34176
isrc=8, fcost=4075.52, rmse=1.83148
isrc=13, fcost=4130.11, rmse=1.84371
isrc=9, fcost=3972.46, rmse=1.80818
fcost_dat=67100.8, rmse=1.4863
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=4387.37, rmse=1.90026
unextended model [rhomin, rhomax]=[0.3, 90.3451]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=5.269955e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=5.705130e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.913894e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.135021e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=5.034465e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=2.206568e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=2.341142e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=6.636048e+04
icycle=8, [scx,scy,scz]=[2,2,1]
rnorm=3.048823e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 90.3451]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.449584e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.150859e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.374094e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.753336e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.053033e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.221064e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 90.3451]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.114322e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.925518e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.679013e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.332717e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.185212e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=67100.8
fcost_mod=8728.29
fcost=75829.1
==========================================================
# iter=19  fk/f0=0.0311782
fg_fwi iter=19: [rhomin,rhomax]=[0.3,86.5295]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 86.5295]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.032186e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.553645e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.790892e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.951284e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.865030e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.598630e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 86.5295]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.578134e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172776e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.425044e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.168252e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.737240e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 86.5295]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.648645e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.054546e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.947615e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.683446e-12
isrc=19, fcost=2771.24, rmse=1.51025
isrc=15, fcost=3225.45, rmse=1.62932
isrc=17, fcost=2205.31, rmse=1.34725
isrc=21, fcost=1840.58, rmse=1.2308
isrc=25, fcost=1957.55, rmse=1.26931
isrc=22, fcost=1897.22, rmse=1.2496
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=1813.69, rmse=1.22178
isrc=6, fcost=1869.81, rmse=1.24054
isrc=2, fcost=2051.45, rmse=1.2994
isrc=10, fcost=2811.24, rmse=1.52111
isrc=7, fcost=2581.74, rmse=1.4577
isrc=4, fcost=2175.2, rmse=1.33802
isrc=23, fcost=2152, rmse=1.33086
isrc=11, fcost=2205.98, rmse=1.34745
isrc=24, fcost=1903.45, rmse=1.25165
isrc=16, fcost=1992.8, rmse=1.28069
isrc=20, fcost=2159.56, rmse=1.3332
isrc=18, fcost=2813.14, rmse=1.52162
isrc=8, fcost=3506.52, rmse=1.69883
isrc=5, fcost=2082.93, rmse=1.30933
isrc=3, fcost=2395.01, rmse=1.404
isrc=12, fcost=2644.52, rmse=1.47532
isrc=13, fcost=3555.25, rmse=1.71059
isrc=9, fcost=3595.2, rmse=1.72018
fcost_dat=62099.7, rmse=1.42984
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=3892.81, rmse=1.78996
unextended model [rhomin, rhomax]=[0.3, 86.5295]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=5.029518e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=5.438844e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.797242e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=2.019588e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=4.778600e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=2.110641e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=2.231120e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=6.411645e+04
icycle=8, [scx,scy,scz]=[2,2,1]
rnorm=2.980850e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 86.5295]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.445242e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.149254e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.332205e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.750597e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.053106e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.157232e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 86.5295]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.137268e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.931414e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.722795e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.339894e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.197674e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=62099.7
fcost_mod=7150
fcost=69249.7
==========================================================
# iter=20  fk/f0=0.028473
fg_fwi iter=20: [rhomin,rhomax]=[0.3,80.6492]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 80.6492]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.032337e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.635445e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.791303e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.985896e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.929416e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.650523e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 80.6492]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.580076e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.173070e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.426614e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.170379e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.738186e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 80.6492]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.654181e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.053797e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.948221e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.679266e-12
isrc=19, fcost=2914.17, rmse=1.54871
isrc=15, fcost=4054.85, rmse=1.82683
isrc=17, fcost=2261.32, rmse=1.36425
isrc=25, fcost=1816.97, rmse=1.22289
isrc=21, fcost=1714.46, rmse=1.18789
isrc=22, fcost=1898.88, rmse=1.25015
isrc=2, fcost=2011.76, rmse=1.28677
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=1714.3, rmse=1.18783
isrc=6, fcost=1722.29, rmse=1.1906
isrc=10, fcost=3823.88, rmse=1.77404
isrc=7, fcost=2630.05, rmse=1.47128
isrc=4, fcost=2170.86, rmse=1.33668
isrc=11, fcost=1914.3, rmse=1.25521
isrc=23, fcost=2129.97, rmse=1.32403
isrc=16, fcost=1831.79, rmse=1.22786
isrc=24, fcost=1937.63, rmse=1.26284
isrc=20, fcost=2175.34, rmse=1.33806
isrc=18, fcost=3126.5, rmse=1.60414
isrc=12, fcost=3062.46, rmse=1.58762
isrc=5, fcost=1919.73, rmse=1.25699
isrc=8, fcost=3835.94, rmse=1.77684
isrc=3, fcost=2201.77, rmse=1.34616
isrc=13, fcost=4350.52, rmse=1.89227
isrc=9, fcost=5131.41, rmse=2.05509
fcost_dat=69070.2, rmse=1.50795
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=6719.11, rmse=2.35162
unextended model [rhomin, rhomax]=[0.3, 80.6492]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.649366e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=4.952412e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.600848e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.834853e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=4.416753e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=2.020630e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=2.045485e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=5.940744e+04
icycle=8, [scx,scy,scz]=[2,2,1]
rnorm=2.816045e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 80.6492]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.452365e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.153958e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.341317e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.773242e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.056801e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.141972e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 80.6492]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.264973e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.956265e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.839503e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.353157e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.211485e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=69070.2
fcost_mod=6439.25
fcost=75509.5
Wolfe condition 1 fails: insufficient misfit decrease!
#line search 0, alp1=0.000000 alp2=1.000000 alp=0.500000
------------------------------------------------
fg_fwi iter=20: [rhomin,rhomax]=[0.3,83.5376]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 83.5376]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.032262e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.594993e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.791110e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.968893e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.898520e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.625437e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 83.5376]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.579096e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172912e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.425738e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.169276e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.737693e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 83.5376]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.651415e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.054152e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.947758e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.681076e-12
isrc=19, fcost=2720.14, rmse=1.49626
isrc=15, fcost=2945.31, rmse=1.55696
isrc=17, fcost=2136.06, rmse=1.32592
isrc=22, fcost=1845.65, rmse=1.2325
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=1723.7, rmse=1.19108
isrc=2, fcost=1945.45, rmse=1.26538
isrc=25, fcost=1818.41, rmse=1.22337
isrc=21, fcost=1732.84, rmse=1.19424
isrc=6, fcost=1760.99, rmse=1.2039
isrc=10, fcost=2546.93, rmse=1.44784
isrc=7, fcost=2459.94, rmse=1.4229
isrc=4, fcost=2103.12, rmse=1.31566
isrc=11, fcost=2013.95, rmse=1.28747
isrc=23, fcost=2055.92, rmse=1.30081
isrc=20, fcost=2091.92, rmse=1.31215
isrc=16, fcost=1871.34, rmse=1.24105
isrc=24, fcost=1815.18, rmse=1.22228
isrc=18, fcost=2733.09, rmse=1.49982
isrc=8, fcost=3239.67, rmse=1.63291
isrc=5, fcost=1975.65, rmse=1.27517
isrc=12, fcost=2618.27, rmse=1.46798
isrc=13, fcost=3332.04, rmse=1.65602
isrc=3, fcost=2209.07, rmse=1.34839
isrc=9, fcost=3772.42, rmse=1.76207
fcost_dat=59761.5, rmse=1.40266
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=4294.46, rmse=1.88004
unextended model [rhomin, rhomax]=[0.3, 83.5376]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.824349e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=5.180803e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.689995e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.921750e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=4.568066e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=2.051884e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=2.131746e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=6.140227e+04
icycle=8, [scx,scy,scz]=[2,2,1]
rnorm=2.880768e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 83.5376]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.435202e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.148263e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.290754e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.755887e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.053668e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.051827e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 83.5376]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.159790e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.937976e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.756387e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.340247e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.197796e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=59761.5
fcost_mod=5914.94
fcost=65676.4
==========================================================
# iter=21  fk/f0=0.0270038
fg_fwi iter=21: [rhomin,rhomax]=[0.3,79.0422]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 79.0422]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.032294e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.628726e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.791194e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.985269e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.930433e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.644404e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 79.0422]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.579736e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172923e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.425973e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.169904e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.737983e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 79.0422]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.653438e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.053963e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.948113e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.680585e-12
isrc=19, fcost=2525.3, rmse=1.44168
isrc=17, fcost=2055.08, rmse=1.30055
isrc=15, fcost=2639.09, rmse=1.4738
isrc=22, fcost=1807.44, rmse=1.21968
isrc=2, fcost=1880.92, rmse=1.24422
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=1674.7, rmse=1.17403
isrc=25, fcost=1779.31, rmse=1.21015
isrc=6, fcost=1712.38, rmse=1.18717
isrc=21, fcost=1684.03, rmse=1.1773
isrc=10, fcost=2282.67, rmse=1.37067
isrc=7, fcost=2332.74, rmse=1.38562
isrc=4, fcost=2045.67, rmse=1.29757
isrc=11, fcost=1918.01, rmse=1.25643
isrc=23, fcost=2028.28, rmse=1.29204
isrc=16, fcost=1820.12, rmse=1.22394
isrc=20, fcost=2041.45, rmse=1.29623
isrc=24, fcost=1794.87, rmse=1.21543
isrc=18, fcost=2553.95, rmse=1.44983
isrc=8, fcost=2878.7, rmse=1.53925
isrc=5, fcost=1898.23, rmse=1.24993
isrc=12, fcost=2449.65, rmse=1.41992
isrc=3, fcost=2161.85, rmse=1.3339
isrc=13, fcost=2875.07, rmse=1.53828
isrc=9, fcost=2948.57, rmse=1.55782
fcost_dat=54866.8, rmse=1.34399
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=3078.73, rmse=1.59183
unextended model [rhomin, rhomax]=[0.3, 79.0422]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.686788e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=5.019663e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.626604e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.851442e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=4.403270e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.988813e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=2.081497e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=6.080213e+04
icycle=8, [scx,scy,scz]=[2,2,1]
rnorm=2.891073e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 79.0422]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.432209e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.147144e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.289404e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.751329e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.052976e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.041867e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 79.0422]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.183024e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.944270e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.771498e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.342560e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.202802e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=54866.8
fcost_mod=4923.4
fcost=59790.2
==========================================================
# iter=22  fk/f0=0.0245836
fg_fwi iter=22: [rhomin,rhomax]=[0.3,75.0908]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 75.0908]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.032323e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.659452e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.791265e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=2.001504e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=5.963402e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.658159e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 75.0908]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.580168e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172845e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.425893e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.170097e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.738075e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 75.0908]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.654976e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.053861e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.948489e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.681497e-12
isrc=19, fcost=2380.7, rmse=1.39979
isrc=15, fcost=2526.7, rmse=1.44208
isrc=17, fcost=1986.96, rmse=1.27881
isrc=22, fcost=1777.82, rmse=1.20964
isrc=2, fcost=1839.6, rmse=1.23048
isrc=25, fcost=1755.87, rmse=1.20215
isrc=21, fcost=1652.7, rmse=1.1663
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=1637.86, rmse=1.16105
isrc=10, fcost=2212.03, rmse=1.3493
isrc=6, fcost=1680.07, rmse=1.17591
isrc=7, fcost=2221.57, rmse=1.3522
isrc=4, fcost=1991.21, rmse=1.28018
isrc=23, fcost=1950.15, rmse=1.26691
isrc=11, fcost=1859.18, rmse=1.23701
isrc=16, fcost=1758.33, rmse=1.20299
isrc=24, fcost=1743.18, rmse=1.1978
isrc=18, fcost=2355.96, rmse=1.3925
isrc=5, fcost=1855.11, rmse=1.23565
isrc=20, fcost=2002.51, rmse=1.2838
isrc=8, fcost=2721.51, rmse=1.49664
isrc=12, fcost=2323.89, rmse=1.38299
isrc=3, fcost=2091.4, rmse=1.31199
isrc=9, fcost=2826.25, rmse=1.52516
isrc=13, fcost=2780.83, rmse=1.51286
fcost_dat=52892.6, rmse=1.31959
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=2961.18, rmse=1.56115
unextended model [rhomin, rhomax]=[0.3, 75.0908]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.587352e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=4.927969e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.588098e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.804164e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=4.336834e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.961671e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=2.048059e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=6.063262e+04
icycle=8, [scx,scy,scz]=[2,2,1]
rnorm=2.902893e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 75.0908]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.431584e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.145646e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.310009e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.743439e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.052052e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.074100e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 75.0908]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.177630e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.945074e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.752954e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.341616e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.204688e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=52892.6
fcost_mod=3918.73
fcost=56811.3
==========================================================
# iter=23  fk/f0=0.0233588
fg_fwi iter=23: [rhomin,rhomax]=[0.3,71.4182]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 71.4182]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.032362e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.695350e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.791361e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=2.019720e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.001609e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.675224e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 71.4182]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.580775e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172776e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.425864e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.170263e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.738156e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 71.4182]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.657186e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.053751e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.949202e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.682268e-12
isrc=19, fcost=2234.62, rmse=1.35617
isrc=15, fcost=2468.1, rmse=1.42526
isrc=17, fcost=1969.65, rmse=1.27323
isrc=22, fcost=1763.8, rmse=1.20486
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=1612.81, rmse=1.15213
isrc=2, fcost=1824.1, rmse=1.22528
isrc=21, fcost=1624.25, rmse=1.15622
isrc=25, fcost=1717.94, rmse=1.18909
isrc=6, fcost=1652.31, rmse=1.16616
isrc=10, fcost=2166.06, rmse=1.3352
isrc=4, fcost=1963.95, rmse=1.27139
isrc=7, fcost=2133.18, rmse=1.32503
isrc=11, fcost=1813.57, rmse=1.22174
isrc=23, fcost=1860.83, rmse=1.23756
isrc=16, fcost=1693.54, rmse=1.18062
isrc=24, fcost=1691.15, rmse=1.17979
isrc=18, fcost=2219.63, rmse=1.35161
isrc=8, fcost=2568.38, rmse=1.45392
isrc=12, fcost=2259.58, rmse=1.36372
isrc=20, fcost=1951.87, rmse=1.26747
isrc=5, fcost=1829.23, rmse=1.227
isrc=9, fcost=2681.3, rmse=1.48554
isrc=3, fcost=2025.25, rmse=1.29107
isrc=13, fcost=2619.97, rmse=1.46845
fcost_dat=51147.6, rmse=1.29764
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=2802.5, rmse=1.51874
unextended model [rhomin, rhomax]=[0.3, 71.4182]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.474435e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=4.809437e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.542147e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.745847e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=4.318967e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.974106e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=2.003764e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=6.042848e+04
icycle=8, [scx,scy,scz]=[2,2,1]
rnorm=2.925500e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 71.4182]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.437394e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.146805e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.361213e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.745531e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.052482e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.149152e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 71.4182]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188435e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.948165e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.747651e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.342151e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.206939e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=51147.6
fcost_mod=3045.54
fcost=54193.1
==========================================================
# iter=24  fk/f0=0.0222823
fg_fwi iter=24: [rhomin,rhomax]=[0.3,64.4449]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 64.4449]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.032448e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.744260e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.791134e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=2.037879e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.031367e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.687782e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 64.4449]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.582230e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172708e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.426263e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.170478e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.738248e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 64.4449]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.662673e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.053645e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.951723e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.682991e-12
isrc=19, fcost=2142.69, rmse=1.32798
isrc=17, fcost=2027.57, rmse=1.29181
isrc=22, fcost=1717.22, rmse=1.18884
isrc=2, fcost=1826.2, rmse=1.22599
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=1559.63, rmse=1.13298
isrc=25, fcost=1658.79, rmse=1.16844
isrc=21, fcost=1565.9, rmse=1.13526
isrc=10, fcost=2145.63, rmse=1.32889
isrc=4, fcost=2036.08, rmse=1.29452
isrc=7, fcost=2072.99, rmse=1.3062
isrc=11, fcost=1721.07, rmse=1.19018
isrc=15, fcost=2399.82, rmse=1.40541
isrc=23, fcost=1833.21, rmse=1.22834
isrc=16, fcost=1623.47, rmse=1.15594
isrc=24, fcost=1705.32, rmse=1.18472
isrc=18, fcost=2046.46, rmse=1.29782
isrc=8, fcost=2606.05, rmse=1.46455
isrc=20, fcost=1865.51, rmse=1.23911
isrc=5, fcost=1809.14, rmse=1.22025
isrc=3, fcost=2015.6, rmse=1.28799
isrc=12, fcost=2331.8, rmse=1.38534
isrc=13, fcost=2507.17, rmse=1.43649
isrc=9, fcost=2651.69, rmse=1.47731
isrc=6, fcost=1584.45, rmse=1.14196
fcost_dat=50277.4, rmse=1.28655
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=2823.93, rmse=1.52454
unextended model [rhomin, rhomax]=[0.3, 64.4449]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.312897e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=4.551987e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.424168e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.600954e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.891575e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.795916e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=1.801375e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=5.350845e+04
icycle=8, [scx,scy,scz]=[2,2,1]
rnorm=2.608997e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 64.4449]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.424618e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.144769e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.306872e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.738420e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.050099e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.094552e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 64.4449]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.227627e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.956349e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.775068e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.345558e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.212011e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=50277.4
fcost_mod=2380.12
fcost=52657.5
==========================================================
# iter=25  fk/f0=0.0216509
fg_fwi iter=25: [rhomin,rhomax]=[0.3,63.9995]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 63.9995]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.032493e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.756290e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.791216e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=2.042465e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.041383e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.690085e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 63.9995]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.582524e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172668e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.426254e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.170101e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.738093e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 63.9995]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.663712e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.053560e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.952012e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.682003e-12
isrc=19, fcost=2008.38, rmse=1.28569
isrc=17, fcost=1960.25, rmse=1.27019
isrc=22, fcost=1676.16, rmse=1.17454
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=1532.77, rmse=1.12318
isrc=2, fcost=1755.97, rmse=1.20218
isrc=25, fcost=1639.94, rmse=1.16179
isrc=21, fcost=1544.71, rmse=1.12755
isrc=10, fcost=1987.07, rmse=1.27885
isrc=7, fcost=1976.02, rmse=1.27528
isrc=4, fcost=1889.84, rmse=1.24716
isrc=11, fcost=1680.03, rmse=1.1759
isrc=23, fcost=1788.93, rmse=1.21341
isrc=16, fcost=1592.83, rmse=1.14498
isrc=15, fcost=2215.98, rmse=1.3505
isrc=24, fcost=1675.04, rmse=1.17415
isrc=18, fcost=1961.83, rmse=1.2707
isrc=8, fcost=2391.49, rmse=1.40296
isrc=5, fcost=1721.68, rmse=1.19039
isrc=12, fcost=2172.03, rmse=1.33704
isrc=20, fcost=1813.07, rmse=1.22157
isrc=3, fcost=1912.37, rmse=1.25458
isrc=6, fcost=1545.49, rmse=1.12783
isrc=9, fcost=2515.37, rmse=1.43884
isrc=13, fcost=2413.61, rmse=1.40944
isrc=14, fcost=2621.91, rmse=1.469
fcost_dat=47992.8, rmse=1.25698
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 63.9995]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.281831e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=4.505013e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.403904e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.580352e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.914278e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.820258e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=1.786302e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=5.368333e+04
icycle=8, [scx,scy,scz]=[2,2,1]
rnorm=2.632077e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 63.9995]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.420757e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.143297e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.298094e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.735451e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.049036e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.109906e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 63.9995]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.183982e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.947027e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.737422e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.339452e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.202742e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=47992.8
fcost_mod=1902.46
fcost=49895.2
==========================================================
# iter=26  fk/f0=0.0205151
fg_fwi iter=26: [rhomin,rhomax]=[0.3,64.1731]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 64.1731]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.032538e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.766148e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.791369e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=2.047123e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.051516e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.690817e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 64.1731]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.582649e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172622e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.426155e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.169580e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.737881e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 64.1731]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.664027e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.053431e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.951766e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.680397e-12
isrc=19, fcost=1943.89, rmse=1.26488
isrc=17, fcost=1848.92, rmse=1.23359
isrc=22, fcost=1636.52, rmse=1.16057
isrc=2, fcost=1689.18, rmse=1.1791
isrc=21, fcost=1532.6, rmse=1.12312
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=1521.38, rmse=1.119
isrc=25, fcost=1623.67, rmse=1.15601
isrc=10, fcost=1946.47, rmse=1.26571
isrc=7, fcost=1918.41, rmse=1.25656
isrc=11, fcost=1660.23, rmse=1.16895
isrc=4, fcost=1800.07, rmse=1.21719
isrc=15, fcost=2190.01, rmse=1.34256
isrc=23, fcost=1731.81, rmse=1.19388
isrc=16, fcost=1583.46, rmse=1.14161
isrc=24, fcost=1618.56, rmse=1.15419
isrc=18, fcost=1896.84, rmse=1.24947
isrc=12, fcost=2077.94, rmse=1.30776
isrc=8, fcost=2288.02, rmse=1.37228
isrc=20, fcost=1778.53, rmse=1.20988
isrc=5, fcost=1720.62, rmse=1.19002
isrc=3, fcost=1806.98, rmse=1.21952
isrc=9, fcost=2493.17, rmse=1.43248
isrc=13, fcost=2314.72, rmse=1.38026
isrc=6, fcost=1539.61, rmse=1.12569
fcost_dat=46639.3, rmse=1.23913
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=2477.69, rmse=1.42802
unextended model [rhomin, rhomax]=[0.3, 64.1731]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.264758e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=4.490995e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.395940e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.570714e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.945452e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.840793e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=1.768699e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=5.337286e+04
icycle=8, [scx,scy,scz]=[2,2,1]
rnorm=2.629394e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 64.1731]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.427578e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.143902e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.330589e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.736070e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.049158e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.189745e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 64.1731]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.128311e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.934993e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.686902e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.333110e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.193854e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=46639.3
fcost_mod=1521.83
fcost=48161.1
==========================================================
# iter=27  fk/f0=0.0198021
fg_fwi iter=27: [rhomin,rhomax]=[0.3,74.2368]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 74.2368]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.032624e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.789023e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.791427e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=2.054456e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.064013e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.696246e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 74.2368]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.583375e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172577e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.426296e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.168940e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.737634e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 74.2368]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.666511e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.053227e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.952523e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.678075e-12
isrc=19, fcost=1885.21, rmse=1.24564
isrc=17, fcost=1762.09, rmse=1.20427
isrc=22, fcost=1595.79, rmse=1.14604
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=1497.3, rmse=1.11011
isrc=2, fcost=1662.19, rmse=1.16964
isrc=25, fcost=1608.03, rmse=1.15043
isrc=21, fcost=1507.66, rmse=1.11395
isrc=10, fcost=1863.5, rmse=1.23844
isrc=7, fcost=1962.43, rmse=1.27089
isrc=4, fcost=1682.78, rmse=1.17686
isrc=11, fcost=1620.68, rmse=1.15494
isrc=23, fcost=1687.39, rmse=1.17847
isrc=15, fcost=2072.23, rmse=1.30596
isrc=16, fcost=1559.9, rmse=1.13308
isrc=24, fcost=1583.91, rmse=1.14176
isrc=18, fcost=1816.18, rmse=1.22262
isrc=20, fcost=1728.57, rmse=1.19277
isrc=12, fcost=2067.22, rmse=1.30438
isrc=3, fcost=1745.91, rmse=1.19874
isrc=5, fcost=1664.59, rmse=1.17049
isrc=13, fcost=2463.38, rmse=1.42389
isrc=6, fcost=1514.31, rmse=1.1164
isrc=9, fcost=2339.57, rmse=1.38765
isrc=14, fcost=2401.32, rmse=1.40584
isrc=8, fcost=2433.23, rmse=1.41515
fcost_dat=45725.4, rmse=1.22693
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 74.2368]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.198989e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=4.370287e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.334605e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.507067e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.773669e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.775359e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=1.692491e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=5.091681e+04
icycle=8, [scx,scy,scz]=[2,2,1]
rnorm=2.526831e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 74.2368]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.428312e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.143672e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.311285e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.731465e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.047693e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.205892e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 74.2368]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.091532e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.925798e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.650528e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.329329e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.187054e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=45725.4
fcost_mod=1276.94
fcost=47002.3
==========================================================
# iter=28  fk/f0=0.0193257
fg_fwi iter=28: [rhomin,rhomax]=[0.3,100]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.032678e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.807844e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.791328e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=2.059786e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.070252e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.697186e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.584082e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172558e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.426498e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.168681e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.737540e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.669008e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.053083e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.953511e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.677151e-12
isrc=19, fcost=1854.11, rmse=1.23532
isrc=17, fcost=1727.27, rmse=1.19232
isrc=22, fcost=1572.05, rmse=1.13748
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=1470.33, rmse=1.10007
isrc=25, fcost=1593.53, rmse=1.14523
isrc=2, fcost=1636.23, rmse=1.16047
isrc=21, fcost=1484.92, rmse=1.10551
isrc=10, fcost=1853.24, rmse=1.23503
isrc=4, fcost=1653.13, rmse=1.16645
isrc=7, fcost=1816.2, rmse=1.22263
isrc=11, fcost=1577.38, rmse=1.13941
isrc=23, fcost=1666.2, rmse=1.17105
isrc=15, fcost=1991.79, rmse=1.28037
isrc=16, fcost=1535.28, rmse=1.1241
isrc=24, fcost=1572.32, rmse=1.13758
isrc=18, fcost=1770.69, rmse=1.20721
isrc=20, fcost=1709.64, rmse=1.18622
isrc=8, fcost=2206.08, rmse=1.34748
isrc=5, fcost=1617.13, rmse=1.15368
isrc=12, fcost=1964.9, rmse=1.27169
isrc=3, fcost=1710.32, rmse=1.18645
isrc=6, fcost=1485.15, rmse=1.1056
isrc=9, fcost=2275.1, rmse=1.3684
isrc=13, fcost=2262.33, rmse=1.36455
fcost_dat=44313.7, rmse=1.20784
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=2308.36, rmse=1.37836
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.127837e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=4.255915e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.276304e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.436660e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.549686e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.678051e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=1.572909e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=4.685112e+04
icycle=8, [scx,scy,scz]=[2,2,1]
rnorm=2.331580e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.422840e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.142519e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.265200e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.726364e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.046437e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.167423e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.080156e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.922973e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.639849e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.328429e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.185619e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=44313.7
fcost_mod=1084.12
fcost=45397.8
==========================================================
# iter=29  fk/f0=0.018666
fg_fwi iter=29: [rhomin,rhomax]=[0.3,100]
--------step 1: forward modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.047120e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.032713e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=8.829650e-10
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.791153e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=2.065687e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.077254e-12
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=8.700640e-13
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.188479e-06
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=3.584908e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.172532e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=5.426639e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.168473e-11
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.737465e-12
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.151832e-05
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=6.672056e-08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.052884e-09
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=3.954652e-10
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=8.676204e-12
isrc=19, fcost=1810.54, rmse=1.22072
isrc=17, fcost=1694.75, rmse=1.18104
isrc=22, fcost=1546.29, rmse=1.12812
------step 2: compute fcost + adjoint source---------
isrc=1, fcost=1440.75, rmse=1.08894
isrc=2, fcost=1614.49, rmse=1.15273
isrc=25, fcost=1565.3, rmse=1.13504
isrc=21, fcost=1456.15, rmse=1.09475
isrc=10, fcost=1796.49, rmse=1.21597
isrc=7, fcost=1767.85, rmse=1.20624
isrc=4, fcost=1629.09, rmse=1.15793
isrc=11, fcost=1543.63, rmse=1.12716
isrc=15, fcost=1922.9, rmse=1.25803
isrc=23, fcost=1639.51, rmse=1.16163
isrc=16, fcost=1507.07, rmse=1.11373
isrc=24, fcost=1557.14, rmse=1.13208
isrc=18, fcost=1728.45, rmse=1.19272
isrc=8, fcost=2173.19, rmse=1.3374
isrc=20, fcost=1685, rmse=1.17764
isrc=12, fcost=1935.7, rmse=1.26221
isrc=5, fcost=1577.99, rmse=1.13963
isrc=13, fcost=2198.63, rmse=1.3452
isrc=3, fcost=1687.58, rmse=1.17854
isrc=9, fcost=2246.27, rmse=1.3597
isrc=6, fcost=1469.33, rmse=1.09969
fcost_dat=43531, rmse=1.19713
-----------step3: adjoint modelling------------
---------------- emf init, freq=0.25 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[13504.7, 13504.7, 19098.6, 100000]
isrc=14, fcost=2336.96, rmse=1.38687
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.047960e+10
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=4.123431e+08
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=1.206572e+08
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.359922e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.296153e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=1.568671e+06
icycle=6, [scx,scy,scz]=[1,2,2]
rnorm=1.455757e+05
icycle=7, [scx,scy,scz]=[2,1,2]
rnorm=4.289035e+04
icycle=8, [scx,scy,scz]=[2,2,1]
rnorm=2.143147e+04
---------------- emf init, freq=1 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[6752.37, 6752.37, 9549.3, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=1.416452e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.141374e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.209734e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.721883e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=1.045252e+06
icycle=5, [scx,scy,scz]=[2,2,1]
rnorm=6.120662e+04
---------------- emf init, freq=2.75 Hz ----------------
logcond=0 (1=average over log(cond), 0=not)
parameters to extend domain: [rhox, rhoy, rhoz]=[5, 5, 10]
extended boundary: [lx, ly, lz, lair]=[4071.83, 4071.83, 5758.44, 100000]
unextended model [rhomin, rhomax]=[0.3, 100]
extended model   [rhomin, rhomax]=[0.3, 1e+08]
------------------ GMG init -------------------
cycleopt=2 (1=V cycle; 2=F cycle; 3=W cycle)
number of V/F/W cycles, ncycle=30
number of pre-smoothing, v1=2
number of post-smoothing, v2=2
number of grid levels, lmax=7
isemicoarsen=1 (1=semi-coarsening, 0=full coarsening)
----------------------------------------------
icycle=0, [scx,scy,scz]=[1,2,2]
rnorm=4.074443e+11
icycle=1, [scx,scy,scz]=[2,1,2]
rnorm=1.921327e+09
icycle=2, [scx,scy,scz]=[2,2,1]
rnorm=4.636946e+07
icycle=3, [scx,scy,scz]=[1,2,2]
rnorm=1.328461e+07
icycle=4, [scx,scy,scz]=[2,1,2]
rnorm=3.185071e+05
----------step 4: compute gradient --------------
-------- stage 5: model regularization ----------
fcost_dat=43531
fcost_mod=935.769
fcost=44466.8
